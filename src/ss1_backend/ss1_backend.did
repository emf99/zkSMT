type Result = variant { Ok : nat64; Err : text };

type MerkleProofEntry = record {
    hash: text;
    is_left: bool;
};

type VerifyRequest = record {
    name: text;
    id: nat64;
    root: text;
    zk_proof: text;
};

type ZKVerifyRequest = record {
    key: text;
    root: text;
    zk_proof: text;
};

service : {
    "greet": (text) -> (text) query;
    "insert": (text, nat64) -> ();
    "delete": (text) -> ();
    "generate_zk_proof": (nat64, nat64, nat64) -> (text);
    "generate_zk_proof_for_user": (text, nat64) -> (text);
    "get_merkle_proof": (text) -> (vec MerkleProofEntry) query;
    "get_root": () -> (text) query;
    "get_root_as_number": () -> (text) query;
    "get_value": (text) -> (Result) query;
    "compute_public_key": (text) -> (nat64) query;
    "get_all_smt_entries": () -> (vec record { text; text }) query;
    "get_smt_stats": () -> (text) query;
    "verify_query_result": (VerifyRequest) -> (bool);
    "verify_zk_membership": (ZKVerifyRequest) -> (bool);
    "verify_real_zk_membership": (text, text, text) -> (bool);
}
